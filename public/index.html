<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>Rohan's Voice Interview Bot</title>
</head>
<body style="font-family:Arial;padding:20px;">
<h2>Rohan's Voice Interview Bot</h2>

<button id="mic">ðŸŽ¤ Start Talking</button>
<p id="status">Status: Ready</p>

<h3>You asked:</h3>
<div id="you">â€”</div>

<h3>Rohan replied:</h3>
<div id="bot">â€”</div>

<p>Or type a question:</p>
<input id="text" placeholder="Ask a question..." style="width:60%;"/>
<button onclick="sendText()">Send</button>

<script>
const you=document.getElementById("you");
const bot=document.getElementById("bot");
const statusEl=document.getElementById("status");
const input=document.getElementById("text");
const mic=document.getElementById("mic");

let rec=null;
if("webkitSpeechRecognition" in window){
  rec=new webkitSpeechRecognition();
  rec.lang="en-US";
  rec.onstart=()=>statusEl.innerText="Status: Listeningâ€¦";
  rec.onend=()=>statusEl.innerText="Status: Thinkingâ€¦";
  rec.onerror=()=>statusEl.innerText="Status: Speech error";

  rec.onresult=e=>{
    const msg=e.results[0][0].transcript;
    handle(msg);
  };
  mic.onclick=()=>rec.start();
} else {
  mic.disabled=true;
  mic.innerText="ðŸŽ¤ Voice not supported in this browser";
}

async function handle(msg){
  you.innerText=msg;
  bot.innerText="Thinkingâ€¦";

  const r=await fetch("/api/chat",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({userMessage:msg})
  });
  const d=await r.json();
  bot.innerText=d.reply || "No reply from AI.";

  if("speechSynthesis" in window){
    const u=new SpeechSynthesisUtterance(d.reply);
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }

  statusEl.innerText="Status: Ready";
}

function sendText(){
  if(input.value.trim()){
    handle(input.value);
    input.value="";
  }
}
</script>
</body>
</html>

